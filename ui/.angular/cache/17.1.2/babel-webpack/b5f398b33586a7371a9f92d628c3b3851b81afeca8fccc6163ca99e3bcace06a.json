{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/products.service\";\nimport * as i3 from \"src/app/services/basket.service\";\nimport * as i4 from \"src/app/services/ecommerce-events.service\";\nimport * as i5 from \"@angular/common\";\nconst _c0 = a0 => ({\n  \"selected\": a0\n});\nfunction ProductPageComponent_div_1_a_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 9);\n    i0.ɵɵlistener(\"click\", function ProductPageComponent_div_1_a_8_Template_a_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const item_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r3.updateProductVariant(item_r2.value.sku));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, item_r2.value == ctx_r1.productVariant));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(item_r2.value.display_name);\n  }\n}\nconst _c1 = a0 => ({\n  \"added\": a0\n});\nfunction ProductPageComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelement(1, \"img\", 3);\n    i0.ɵɵelementStart(2, \"div\", 4)(3, \"h3\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 5);\n    i0.ɵɵtemplate(8, ProductPageComponent_div_1_a_8_Template, 2, 4, \"a\", 6);\n    i0.ɵɵpipe(9, \"keyvalue\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"a\", 7);\n    i0.ɵɵlistener(\"click\", function ProductPageComponent_div_1_Template_a_click_10_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.basketService.buyWithOneClick(ctx_r5.product, ctx_r5.productVariant));\n    });\n    i0.ɵɵtext(11, \" Buy \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"a\", 8);\n    i0.ɵɵlistener(\"click\", function ProductPageComponent_div_1_Template_a_click_12_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.addToBasket());\n    });\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"src\", \"assets/images/\", ctx_r0.productVariant.image, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵpropertyInterpolate2(\"alt\", \"product-logo-\", ctx_r0.product.name, \"-\", ctx_r0.productVariant.name, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.product.name, \": \", ctx_r0.productsService.getProductVariantPriceAsCurrency(ctx_r0.productVariant), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.product.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(9, 9, ctx_r0.product.variants));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(11, _c1, ctx_r0.addedToCart));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.addToCartText, \" \");\n  }\n}\n/**\n * Product page component.\n */\nexport let ProductPageComponent = /*#__PURE__*/(() => {\n  class ProductPageComponent {\n    constructor(route, productsService, basketService, ecommerceEventsService) {\n      this.route = route;\n      this.productsService = productsService;\n      this.basketService = basketService;\n      this.ecommerceEventsService = ecommerceEventsService;\n      this.productId = '';\n      this.addedToCart = false;\n      this.setDefaultAddToCartText();\n    }\n    ngOnInit() {\n      this.route.paramMap.subscribe(params => {\n        this.productId = params.get('id');\n      });\n      if (this.productId != null) {\n        this.product = this.productsService.products[this.productId];\n        this.productVariant = this.productsService.getDefaultProductVariant(this.product);\n        this.ecommerceEventsService.sendViewItemEvent(this.product, this.productVariant);\n      }\n    }\n    /**\n     * Set the default add to cart text for the button.\n     */\n    setDefaultAddToCartText() {\n      this.addToCartText = 'Add to Basket';\n    }\n    /**\n     * Update the product variant based on the sku argument.\n     * @param sku the sku of the new variant.\n     */\n    updateProductVariant(sku) {\n      if (this.product !== undefined) {\n        this.productVariant = this.product.variants[sku];\n        this.ecommerceEventsService.sendViewItemEvent(this.product, this.productVariant);\n      }\n    }\n    /**\n     * Add the product to the basket.\n     */\n    addToBasket() {\n      if (this.product != null && this.productVariant != null) {\n        this.addedToCart = true;\n        this.addToCartText = 'Done';\n        this.basketService.updateBasket(this.product, this.productVariant, 1);\n        this.ecommerceEventsService.sendAddToCartEvent(this.product, this.productVariant);\n        this.basketService.emitAddToCartEvent();\n        setTimeout(() => {\n          this.addedToCart = false;\n          this.setDefaultAddToCartText();\n        }, 300);\n      }\n    }\n    static #_ = this.ɵfac = function ProductPageComponent_Factory(t) {\n      return new (t || ProductPageComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ProductsService), i0.ɵɵdirectiveInject(i3.BasketService), i0.ɵɵdirectiveInject(i4.EcommerceEventsService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProductPageComponent,\n      selectors: [[\"app-product-page\"]],\n      decls: 2,\n      vars: 1,\n      consts: [[1, \"container-fluid\", \"container-highlight\"], [\"class\", \"product\", 4, \"ngIf\"], [1, \"product\"], [1, \"product-image\", 3, \"src\", \"alt\"], [1, \"product-text\"], [1, \"size-group\"], [\"class\", \"variant-btn btn\", 3, \"ngClass\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"buy-one-click\", 3, \"click\"], [1, \"btn\", \"add-to-basket\", 3, \"ngClass\", \"click\"], [1, \"variant-btn\", \"btn\", 3, \"ngClass\", \"click\"]],\n      template: function ProductPageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, ProductPageComponent_div_1_Template, 14, 13, \"div\", 1);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.product !== undefined && ctx.productVariant !== undefined);\n        }\n      },\n      dependencies: [i5.NgClass, i5.NgForOf, i5.NgIf, i5.KeyValuePipe],\n      styles: [\".product[_ngcontent-%COMP%]   .size-group[_ngcontent-%COMP%]{margin-bottom:10px}.product[_ngcontent-%COMP%]   .variant-btn[_ngcontent-%COMP%]{background:#373b3e;margin:3px}.product[_ngcontent-%COMP%]   .variant-btn.selected[_ngcontent-%COMP%]{background:#646669}.add-to-basket[_ngcontent-%COMP%]{width:140px}.add-to-basket.added[_ngcontent-%COMP%]{background-color:#03dac5;width:140px}\"]\n    });\n  }\n  return ProductPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}